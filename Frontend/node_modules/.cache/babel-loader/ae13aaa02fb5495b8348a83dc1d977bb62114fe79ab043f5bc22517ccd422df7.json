{"ast":null,"code":"import { frame, cancelFrame } from '../frameloop/frame.mjs';\nimport { numberValueTypes } from '../value/types/maps/number.mjs';\nimport { getValueAsType } from '../value/types/utils/get-as-type.mjs';\nclass MotionValueState {\n  constructor() {\n    this.latest = {};\n    this.values = new Map();\n  }\n  set(name, value, render, computed, useDefaultValueType = true) {\n    const existingValue = this.values.get(name);\n    if (existingValue) {\n      existingValue.onRemove();\n    }\n    const onChange = () => {\n      const v = value.get();\n      if (useDefaultValueType) {\n        this.latest[name] = getValueAsType(v, numberValueTypes[name]);\n      } else {\n        this.latest[name] = v;\n      }\n      render && frame.render(render);\n    };\n    onChange();\n    const cancelOnChange = value.on(\"change\", onChange);\n    computed && value.addDependent(computed);\n    const remove = () => {\n      cancelOnChange();\n      render && cancelFrame(render);\n      this.values.delete(name);\n      computed && value.removeDependent(computed);\n    };\n    this.values.set(name, {\n      value,\n      onRemove: remove\n    });\n    return remove;\n  }\n  get(name) {\n    return this.values.get(name)?.value;\n  }\n  destroy() {\n    for (const value of this.values.values()) {\n      value.onRemove();\n    }\n  }\n}\nexport { MotionValueState };","map":{"version":3,"names":["MotionValueState","constructor","latest","values","Map","set","name","value","render","computed","useDefaultValueType","existingValue","get","onRemove","onChange","v","getValueAsType","numberValueTypes","frame","cancelOnChange","on","addDependent","remove","cancelFrame","delete","removeDependent","destroy"],"sources":["/home/zeinab/ziblog/Frontend/node_modules/motion-dom/src/effects/MotionValueState.ts"],"sourcesContent":["import { AnyResolvedKeyframe } from \"../animation/types\"\nimport { cancelFrame, frame } from \"../frameloop/frame\"\nimport { MotionValue } from \"../value\"\nimport { numberValueTypes } from \"../value/types/maps/number\"\nimport { getValueAsType } from \"../value/types/utils/get-as-type\"\n\nexport class MotionValueState {\n    latest: { [name: string]: AnyResolvedKeyframe } = {}\n\n    private values = new Map<\n        string,\n        { value: MotionValue; onRemove: VoidFunction }\n    >()\n\n    set(\n        name: string,\n        value: MotionValue,\n        render?: VoidFunction,\n        computed?: MotionValue,\n        useDefaultValueType = true\n    ) {\n        const existingValue = this.values.get(name)\n\n        if (existingValue) {\n            existingValue.onRemove()\n        }\n\n        const onChange = () => {\n            const v = value.get()\n\n            if (useDefaultValueType) {\n                this.latest[name] = getValueAsType(v, numberValueTypes[name])\n            } else {\n                this.latest[name] = v\n            }\n\n            render && frame.render(render)\n        }\n\n        onChange()\n\n        const cancelOnChange = value.on(\"change\", onChange)\n\n        computed && value.addDependent(computed)\n\n        const remove = () => {\n            cancelOnChange()\n            render && cancelFrame(render)\n            this.values.delete(name)\n            computed && value.removeDependent(computed)\n        }\n\n        this.values.set(name, { value, onRemove: remove })\n\n        return remove\n    }\n\n    get(name: string): MotionValue | undefined {\n        return this.values.get(name)?.value\n    }\n\n    destroy() {\n        for (const value of this.values.values()) {\n            value.onRemove()\n        }\n    }\n}\n"],"mappings":";;;MAMaA,gBAAgB;EAA7BC,YAAA;IACI,IAAM,CAAAC,MAAA,GAA4C,EAAE;IAE5C,KAAAC,MAAM,GAAG,IAAIC,GAAG,EAGrB;;EAEHC,GAAGA,CACCC,IAAY,EACZC,KAAkB,EAClBC,MAAqB,EACrBC,QAAsB,EACtBC,mBAAmB,GAAG,IAAI;IAE1B,MAAMC,aAAa,GAAG,IAAI,CAACR,MAAM,CAACS,GAAG,CAACN,IAAI,CAAC;IAE3C,IAAIK,aAAa,EAAE;MACfA,aAAa,CAACE,QAAQ,EAAE;;IAG5B,MAAMC,QAAQ,GAAGA,CAAA,KAAK;MAClB,MAAMC,CAAC,GAAGR,KAAK,CAACK,GAAG,EAAE;MAErB,IAAIF,mBAAmB,EAAE;QACrB,IAAI,CAACR,MAAM,CAACI,IAAI,CAAC,GAAGU,cAAc,CAACD,CAAC,EAAEE,gBAAgB,CAACX,IAAI,CAAC,CAAC;OAChE,MAAM;QACH,IAAI,CAACJ,MAAM,CAACI,IAAI,CAAC,GAAGS,CAAC;;MAGzBP,MAAM,IAAIU,KAAK,CAACV,MAAM,CAACA,MAAM,CAAC;IAClC,CAAC;IAEDM,QAAQ,EAAE;IAEV,MAAMK,cAAc,GAAGZ,KAAK,CAACa,EAAE,CAAC,QAAQ,EAAEN,QAAQ,CAAC;IAEnDL,QAAQ,IAAIF,KAAK,CAACc,YAAY,CAACZ,QAAQ,CAAC;IAExC,MAAMa,MAAM,GAAGA,CAAA,KAAK;MAChBH,cAAc,EAAE;MAChBX,MAAM,IAAIe,WAAW,CAACf,MAAM,CAAC;MAC7B,IAAI,CAACL,MAAM,CAACqB,MAAM,CAAClB,IAAI,CAAC;MACxBG,QAAQ,IAAIF,KAAK,CAACkB,eAAe,CAAChB,QAAQ,CAAC;IAC/C,CAAC;IAED,IAAI,CAACN,MAAM,CAACE,GAAG,CAACC,IAAI,EAAE;MAAEC,KAAK;MAAEM,QAAQ,EAAES;IAAM,CAAE,CAAC;IAElD,OAAOA,MAAM;;EAGjBV,GAAGA,CAACN,IAAY;IACZ,OAAO,IAAI,CAACH,MAAM,CAACS,GAAG,CAACN,IAAI,CAAC,EAAEC,KAAK;;EAGvCmB,OAAOA,CAAA;IACH,KAAK,MAAMnB,KAAK,IAAI,IAAI,CAACJ,MAAM,CAACA,MAAM,EAAE,EAAE;MACtCI,KAAK,CAACM,QAAQ,EAAE;;;AAG3B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}