{"ast":null,"code":"import { resize, frame, cancelFrame, frameData } from 'motion-dom';\nimport { noop } from 'motion-utils';\nimport { createScrollInfo } from './info.mjs';\nimport { createOnScrollHandler } from './on-scroll-handler.mjs';\nconst scrollListeners = new WeakMap();\nconst resizeListeners = new WeakMap();\nconst onScrollHandlers = new WeakMap();\nconst scrollSize = new WeakMap();\nconst dimensionCheckProcesses = new WeakMap();\nconst getEventTarget = element => element === document.scrollingElement ? window : element;\nfunction scrollInfo(onScroll, {\n  container = document.scrollingElement,\n  trackContentSize = false,\n  ...options\n} = {}) {\n  if (!container) return noop;\n  let containerHandlers = onScrollHandlers.get(container);\n  /**\n   * Get the onScroll handlers for this container.\n   * If one isn't found, create a new one.\n   */\n  if (!containerHandlers) {\n    containerHandlers = new Set();\n    onScrollHandlers.set(container, containerHandlers);\n  }\n  /**\n   * Create a new onScroll handler for the provided callback.\n   */\n  const info = createScrollInfo();\n  const containerHandler = createOnScrollHandler(container, onScroll, info, options);\n  containerHandlers.add(containerHandler);\n  /**\n   * Check if there's a scroll event listener for this container.\n   * If not, create one.\n   */\n  if (!scrollListeners.has(container)) {\n    const measureAll = () => {\n      for (const handler of containerHandlers) {\n        handler.measure(frameData.timestamp);\n      }\n      frame.preUpdate(notifyAll);\n    };\n    const notifyAll = () => {\n      for (const handler of containerHandlers) {\n        handler.notify();\n      }\n    };\n    const listener = () => frame.read(measureAll);\n    scrollListeners.set(container, listener);\n    const target = getEventTarget(container);\n    window.addEventListener(\"resize\", listener);\n    if (container !== document.documentElement) {\n      resizeListeners.set(container, resize(container, listener));\n    }\n    target.addEventListener(\"scroll\", listener);\n    listener();\n  }\n  /**\n   * Enable content size tracking if requested and not already enabled.\n   */\n  if (trackContentSize && !dimensionCheckProcesses.has(container)) {\n    const listener = scrollListeners.get(container);\n    // Store initial scroll dimensions (object is reused to avoid allocation)\n    const size = {\n      width: container.scrollWidth,\n      height: container.scrollHeight\n    };\n    scrollSize.set(container, size);\n    // Add frame-based scroll dimension checking to detect content changes\n    const checkScrollDimensions = () => {\n      const newWidth = container.scrollWidth;\n      const newHeight = container.scrollHeight;\n      if (size.width !== newWidth || size.height !== newHeight) {\n        listener();\n        size.width = newWidth;\n        size.height = newHeight;\n      }\n    };\n    // Schedule with keepAlive=true to run every frame\n    const dimensionCheckProcess = frame.read(checkScrollDimensions, true);\n    dimensionCheckProcesses.set(container, dimensionCheckProcess);\n  }\n  const listener = scrollListeners.get(container);\n  frame.read(listener, false, true);\n  return () => {\n    cancelFrame(listener);\n    /**\n     * Check if we even have any handlers for this container.\n     */\n    const currentHandlers = onScrollHandlers.get(container);\n    if (!currentHandlers) return;\n    currentHandlers.delete(containerHandler);\n    if (currentHandlers.size) return;\n    /**\n     * If no more handlers, remove the scroll listener too.\n     */\n    const scrollListener = scrollListeners.get(container);\n    scrollListeners.delete(container);\n    if (scrollListener) {\n      getEventTarget(container).removeEventListener(\"scroll\", scrollListener);\n      resizeListeners.get(container)?.();\n      window.removeEventListener(\"resize\", scrollListener);\n    }\n    // Clean up scroll dimension checking\n    const dimensionCheckProcess = dimensionCheckProcesses.get(container);\n    if (dimensionCheckProcess) {\n      cancelFrame(dimensionCheckProcess);\n      dimensionCheckProcesses.delete(container);\n    }\n    scrollSize.delete(container);\n  };\n}\nexport { scrollInfo };","map":{"version":3,"names":["scrollListeners","WeakMap","resizeListeners","onScrollHandlers","scrollSize","dimensionCheckProcesses","getEventTarget","element","document","scrollingElement","window","scrollInfo","onScroll","container","trackContentSize","options","noop","containerHandlers","get","Set","set","info","createScrollInfo","containerHandler","createOnScrollHandler","add","has","measureAll","handler","measure","frameData","timestamp","frame","preUpdate","notifyAll","notify","listener","read","target","addEventListener","documentElement","resize","size","width","scrollWidth","height","scrollHeight","checkScrollDimensions","newWidth","newHeight","dimensionCheckProcess","cancelFrame","currentHandlers","delete","scrollListener","removeEventListener"],"sources":["/home/zeinab/ziblog/Frontend/node_modules/framer-motion/src/render/dom/scroll/track.ts"],"sourcesContent":["import { cancelFrame, frame, frameData, resize, Process } from \"motion-dom\"\nimport { noop } from \"motion-utils\"\nimport { createScrollInfo } from \"./info\"\nimport { createOnScrollHandler } from \"./on-scroll-handler\"\nimport { OnScrollHandler, OnScrollInfo, ScrollInfoOptions } from \"./types\"\n\nconst scrollListeners = new WeakMap<Element, VoidFunction>()\nconst resizeListeners = new WeakMap<Element, VoidFunction>()\nconst onScrollHandlers = new WeakMap<Element, Set<OnScrollHandler>>()\nconst scrollSize = new WeakMap<Element, { width: number; height: number }>()\nconst dimensionCheckProcesses = new WeakMap<Element, Process>()\n\nexport type ScrollTargets = Array<HTMLElement>\n\nconst getEventTarget = (element: Element) =>\n    element === document.scrollingElement ? window : element\n\nexport function scrollInfo(\n    onScroll: OnScrollInfo,\n    {\n        container = document.scrollingElement as Element,\n        trackContentSize = false,\n        ...options\n    }: ScrollInfoOptions = {}\n) {\n    if (!container) return noop as VoidFunction\n\n    let containerHandlers = onScrollHandlers.get(container)\n\n    /**\n     * Get the onScroll handlers for this container.\n     * If one isn't found, create a new one.\n     */\n    if (!containerHandlers) {\n        containerHandlers = new Set()\n        onScrollHandlers.set(container, containerHandlers)\n    }\n\n    /**\n     * Create a new onScroll handler for the provided callback.\n     */\n    const info = createScrollInfo()\n    const containerHandler = createOnScrollHandler(\n        container,\n        onScroll,\n        info,\n        options\n    )\n    containerHandlers.add(containerHandler)\n\n    /**\n     * Check if there's a scroll event listener for this container.\n     * If not, create one.\n     */\n    if (!scrollListeners.has(container)) {\n        const measureAll = () => {\n            for (const handler of containerHandlers) {\n                handler.measure(frameData.timestamp)\n            }\n\n            frame.preUpdate(notifyAll)\n        }\n\n        const notifyAll = () => {\n            for (const handler of containerHandlers) {\n                handler.notify()\n            }\n        }\n\n        const listener = () => frame.read(measureAll)\n\n        scrollListeners.set(container, listener)\n\n        const target = getEventTarget(container)\n        window.addEventListener(\"resize\", listener)\n        if (container !== document.documentElement) {\n            resizeListeners.set(container, resize(container, listener))\n        }\n\n        target.addEventListener(\"scroll\", listener)\n\n        listener()\n    }\n\n    /**\n     * Enable content size tracking if requested and not already enabled.\n     */\n    if (trackContentSize && !dimensionCheckProcesses.has(container)) {\n        const listener = scrollListeners.get(container)!\n\n        // Store initial scroll dimensions (object is reused to avoid allocation)\n        const size = {\n            width: container.scrollWidth,\n            height: container.scrollHeight,\n        }\n        scrollSize.set(container, size)\n\n        // Add frame-based scroll dimension checking to detect content changes\n        const checkScrollDimensions: Process = () => {\n            const newWidth = container.scrollWidth\n            const newHeight = container.scrollHeight\n\n            if (size.width !== newWidth || size.height !== newHeight) {\n                listener()\n                size.width = newWidth\n                size.height = newHeight\n            }\n        }\n\n        // Schedule with keepAlive=true to run every frame\n        const dimensionCheckProcess = frame.read(checkScrollDimensions, true)\n        dimensionCheckProcesses.set(container, dimensionCheckProcess)\n    }\n\n    const listener = scrollListeners.get(container)!\n    frame.read(listener, false, true)\n\n    return () => {\n        cancelFrame(listener)\n\n        /**\n         * Check if we even have any handlers for this container.\n         */\n        const currentHandlers = onScrollHandlers.get(container)\n        if (!currentHandlers) return\n\n        currentHandlers.delete(containerHandler)\n\n        if (currentHandlers.size) return\n\n        /**\n         * If no more handlers, remove the scroll listener too.\n         */\n        const scrollListener = scrollListeners.get(container)\n        scrollListeners.delete(container)\n\n        if (scrollListener) {\n            getEventTarget(container).removeEventListener(\n                \"scroll\",\n                scrollListener\n            )\n            resizeListeners.get(container)?.()\n            window.removeEventListener(\"resize\", scrollListener)\n        }\n\n        // Clean up scroll dimension checking\n        const dimensionCheckProcess = dimensionCheckProcesses.get(container)\n        if (dimensionCheckProcess) {\n            cancelFrame(dimensionCheckProcess)\n            dimensionCheckProcesses.delete(container)\n        }\n        scrollSize.delete(container)\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}